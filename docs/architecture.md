# Frontend Architecture Guide

이 문서는 BIGTABLET Frontend Template에서 사용하는  
프론트엔드 아키텍처와 핵심 설계 원칙을 설명합니다.

본 문서는 **구현 세부 코드보다는 구조와 의도**를 중심으로 하며,  
실제 코드 작성 규칙은 별도의 conventions 문서를 따릅니다.

---

## 아키텍처 개요

BIGTABLET Frontend Template는 **도메인 중심 아키텍처**를 기반으로 설계되었습니다.

목표는 다음과 같습니다.

- 비즈니스 로직과 UI의 명확한 분리
- 서버 통신과 데이터 검증의 일관성 확보
- 프로젝트 규모 확장 시 구조 변경 최소화
- 신규 팀원이 빠르게 구조를 이해할 수 있는 코드베이스 유지

---

## 레이어 구성과 책임

프론트엔드 코드는 역할에 따라 다음 레이어로 구분됩니다.

### App Layer

- Next.js App Router 기반 라우팅과 레이아웃을 담당합니다.
- 페이지 진입점과 전역 레이아웃만 정의합니다.
- 비즈니스 로직이나 서버 통신 로직은 포함하지 않습니다.

역할 요약:
- 라우팅
- 레이아웃 구성
- 전역 스타일 적용

---

### Domain Layer (Entities)

- 비즈니스 도메인의 최소 단위를 정의합니다.
- 서버 API, 데이터 스키마, 상수 등 도메인 자체에 대한 정의를 포함합니다.
- 다른 도메인에 의존하지 않도록 설계합니다.

역할 요약:
- 서버 API 정의
- Zod 스키마 정의
- 도메인 상수 관리

---

### Feature Layer

- 하나의 사용자 행동 또는 유스케이스를 구현합니다.
- 하나 이상의 entity를 조합하여 실제 동작을 구성합니다.
- 화면과 직접 연결되는 로직을 담당합니다.

역할 요약:
- 유스케이스 구현
- 상태 관리
- 도메인 로직 조합

---

### Process Layer

- 여러 feature가 순차적으로 결합되는 흐름을 담당합니다.
- 인증, 온보딩 등 복합적인 사용자 플로우를 구현합니다.
- 페이지 단위 이상의 로직을 처리합니다.

역할 요약:
- 다단계 플로우 제어
- 전역 상태 흐름 관리

---

### Widget Layer

- 화면을 구성하는 UI 블록 단위입니다.
- feature와 entity를 조합하여 레이아웃을 구성합니다.
- 재사용 가능한 화면 단위 컴포넌트를 담당합니다.

역할 요약:
- UI 조합
- 레이아웃 구성
- 페이지 단위 컴포넌트 제공

---

### Shared Layer

- 전역적으로 재사용되는 코드들을 관리합니다.
- 특정 도메인에 종속되지 않는 로직만 포함합니다.

포함 대상:
- 공통 hooks
- 공통 라이브러리
- API 인프라
- 스타일 및 디자인 토큰 접근 코드

---

## 의존성 방향

의존성은 **단방향**으로만 허용됩니다.

Shared → Entities → Features → Processes → Widgets → App

하위 레이어는 상위 레이어에 의존할 수 없으며,  
이를 통해 순환 의존성과 구조 붕괴를 방지합니다.

---

## 서버 통신 아키텍처

서버 통신은 **단일 Axios 인스턴스 + Zod 기반 파싱**을 표준으로 합니다.

### 기본 원칙

- Axios를 직접 사용하지 않습니다.
- 모든 서버 응답은 Zod 스키마로 검증합니다.
- HTTP 메서드별 공통 API 함수만 사용합니다.
- 에러는 공통 파서를 통해 변환합니다.

이 구조를 통해 다음을 보장합니다.

- 런타임 데이터 오류 조기 발견
- 서버 스펙 변경에 대한 안전성 확보
- API 사용 방식의 일관성 유지

---

## 에러 처리 흐름

에러 처리는 다음 흐름을 따릅니다.

1. Axios 요청 수행
2. 네트워크 또는 서버 에러 발생
3. 공통 에러 파서를 통해 표준 에러 형태로 변환
4. 상위 레이어에서 에러 상태 처리

이 방식은 UI 레벨에서 예측 가능한 에러 처리를 가능하게 합니다.

---

## 데이터 검증 전략

- 서버에서 내려오는 모든 데이터는 신뢰하지 않습니다.
- Zod 스키마를 통해 런타임 검증을 수행합니다.
- 검증 실패 시 즉시 에러로 처리합니다.

이를 통해 타입 정의와 실제 데이터 간의 불일치를 방지합니다.

---

## 상태 관리 전략

- 서버 상태는 React Query를 통해 관리합니다.
- 캐싱, 재시도, 무효화 로직을 표준화합니다.
- 클라이언트 상태와 서버 상태를 명확히 분리합니다.

---

## UI 아키텍처

- 모든 UI는 Bigtablet Design System을 기준으로 구현합니다.
- 임의의 색상, 간격, 폰트 값 사용은 지양합니다.
- 디자인 토큰을 통해 UI 일관성을 유지합니다.

---

## 확장 전략

신규 기능 추가 시 다음 순서를 권장합니다.

1. 도메인(entity) 정의
2. 서버 API 및 스키마 작성
3. feature 단위 로직 구현
4. 필요 시 process로 흐름 구성
5. widget을 통해 화면 구성
6. app 레이어에서 라우팅 연결

이 순서를 따르면 구조 변경 없이 기능 확장이 가능합니다.

---

## 문서 간 관계

- 본 문서는 구조와 설계 의도를 설명합니다.
- 구체적인 코드 작성 규칙은 conventions 문서를 따릅니다.
- 신규 합류자는 onboarding 문서를 먼저 참고합니다.